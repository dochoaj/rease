/*!
 * froala_editor v2.0.1 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms
 * Copyright 2014-2015 Froala Labs
 */
!function(e){"function"==typeof define&&define.amd?module.exports=function(t,n){return void 0===n&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(n),n}:e(jQuery)}(function(e){"use strict";e.extend(e.FroalaEditor.DEFAULTS,{lineBreakerTags:["table","hr","iframe","form","dl"],lineBreakerOffset:10}),e.FroalaEditor.PLUGINS.lineBreaker=function(t){function n(n,i){var a,o,r,s,l,c,d,u;if(null==n)s=i.parent(),l=s.offset().top,d=i.offset().top,a=d-Math.min((d-l)/2,t.opts.lineBreakerOffset),r=s.outerWidth(),o=s.offset().left;else if(null==i)s=n.parent(),c=s.offset().top+s.outerHeight(),u=n.offset().top+n.outerHeight(),a=u+Math.min((c-u)/2,t.opts.lineBreakerOffset),r=s.outerWidth(),o=s.offset().left;else{s=n.parent();var f=n.offset().top+n.height(),g=i.offset().top;if(f>g)return!1;a=(f+g)/2,r=s.outerWidth(),o=s.offset().left}t.opts.iframe&&(o+=t.$iframe.offset().left-e(t.original_window).scrollLeft(),a+=t.$iframe.offset().top-e(t.original_window).scrollTop()),p.css("top",a-t.window.pageYOffset),p.css("left",o-t.window.pageXOffset),p.css("width",r),p.data("tag1",n),p.data("tag2",i),p.show()}function i(e,i){var o,r,s=e.offset().top,l=e.offset().top+e.outerHeight();if(Math.abs(l-i)<=t.opts.lineBreakerOffset||Math.abs(i-s)<=t.opts.lineBreakerOffset)if(Math.abs(l-i)<Math.abs(i-s)){r=e.get(0);for(var c=r.nextSibling;c&&c.nodeType==Node.TEXT_NODE&&0===c.textContent.length;)c=c.nextSibling;c?(o=a(c),o&&n(e,o)):n(e,null)}else r=e.get(0),r.previousSibling?(o=a(r.previousSibling),o&&n(o,e)):n(null,e)}function a(n){if(n){var i=e(n);if(0===t.$el.find(i).length)return null;if(n.nodeType!=Node.TEXT_NODE&&t.opts.lineBreakerTags.indexOf(n.tagName.toLowerCase())>=0)return i;if(i.parents(t.opts.lineBreakerTags.join(",")).length>0)return n=i.parents(t.opts.lineBreakerTags.join(",")).get(0),e(n)}return null}function o(n){h=null,p.hide();var o,r,s,l=null,c=t.document.elementFromPoint(n.pageX-t.window.pageXOffset,n.pageY-t.window.pageYOffset);if(t.node.isElement(c))for(o=1;o<=t.opts.lineBreakerOffset;o++){if(r=t.document.elementFromPoint(n.pageX-t.window.pageXOffset,n.pageY-t.window.pageYOffset-o),r&&!t.node.isElement(r)&&r!=t.$wp.get(0)&&e(r).parents(t.$wp).length){l=a(r);break}if(s=t.document.elementFromPoint(n.pageX-t.window.pageXOffset,n.pageY-t.window.pageYOffset+o),s&&!t.node.isElement(s)&&s!=t.$wp.get(0)&&e(s).parents(t.$wp).length){l=a(s);break}}else l=a(c);l&&i(l,n.pageY)}function r(e){g===!1&&(h&&clearTimeout(h),h=setTimeout(o,30,e))}function s(){h&&clearTimeout(h),p.hide()}function l(){g=!0,s()}function c(){g=!1}function d(n){n.preventDefault(),p.hide();var i=p.data("tag1"),a=p.data("tag2"),o=t.html.defaultTag();null==i?o&&"TD"!=a.parent().get(0).tagName?a.before("<"+o+">"+e.FroalaEditor.MARKERS+"<br></"+o+">"):a.before(e.FroalaEditor.MARKERS+"<br>"):o&&"TD"!=i.parent().get(0).tagName?i.after("<"+o+">"+e.FroalaEditor.MARKERS+"<br></"+o+">"):i.after(e.FroalaEditor.MARKERS+"<br>"),t.selection.restore()}function u(){p=e('<div class="fr-line-breaker"><a role="button" tabindex="-1" title="'+t.language.translate("Break")+'"><i class="fa fa-plus"></i></a></div>'),t.$wp.append(p),t.events.on("destroy",function(){p.html("").removeData().remove()},!0),p.on("mouseleave.linebreaker"+t.id,s),p.on("mousemove",function(e){e.stopPropagation()}),p.on("mousedown","a",function(e){e.stopPropagation()}),p.on("click","a",d),t.events.on("destroy",function(){p.off("mouseleave.linebreaker"),p.off("mousedown"),p.off("mousedown","a"),p.off("click","a")},!0)}function f(){return t.$wp?(u(),g=!1,t.$window.on("mousemove.linebreaker"+t.id,r),e(t.window).on("scroll.linebreaker"+t.id,s),e(t.window).on("mousedown.linebreaker"+t.id,l),e(t.window).on("mouseup.linebreaker"+t.id,c),void t.events.on("destroy",function(){t.$window.off("mousemove.linebreaker"+t.id),e(t.window).off("scroll.linebreaker"+t.id),e(t.window).off("mousedown.linebreaker"+t.id),e(t.window).off("mouseup.linebreaker"+t.id)},!0)):!1}var p,g,h;return{_init:f}}});