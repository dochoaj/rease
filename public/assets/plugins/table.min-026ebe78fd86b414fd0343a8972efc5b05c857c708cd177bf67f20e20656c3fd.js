/*!
 * froala_editor v2.0.1 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms
 * Copyright 2014-2015 Froala Labs
 */
!function(e){"function"==typeof define&&define.amd?module.exports=function(t,n){return void 0===n&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(n),n}:e(jQuery)}(function(e){"use strict";e.extend(e.FroalaEditor.POPUP_TEMPLATES,{"table.insert":"[_BUTTONS_][_ROWS_COLUMNS_]","table.edit":"[_BUTTONS_]","table.colors":"[_BUTTONS_][_COLORS_]"}),e.extend(e.FroalaEditor.DEFAULTS,{tableInsertMaxSize:10,tableEditButtons:["tableHeader","tableRemove","|","tableRows","tableColumns","tableStyle","-","tableCells","tableCellBackground","tableCellVerticalAlign","tableCellHorizontalAlign","tableCellStyle"],tableInsertButtons:["tableBack","|"],tableResizerOffset:5,tableResizingLimit:30,tableColorsButtons:["tableBack","|"],tableColors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],tableColorsStep:7,tableCellStyles:{"fr-highlighted":"Highlighted","fr-thick":"Thick"},tableStyles:{"fr-dashed-borders":"Dashed Borders","fr-alternate-rows":"Alternate Rows"},tableCellMultipleStyles:!0,tableMultipleStyles:!0}),e.FroalaEditor.PLUGINS.table=function(t){function n(){var e=t.$tb.find('.fr-command[data-cmd="insertTable"]'),n=t.popups.get("table.insert");if(n||(n=r()),!n.hasClass("fr-active")){t.popups.refresh("table.insert"),t.popups.setContainer("table.insert",t.$tb);var i=e.offset().left+e.outerWidth()/2,a=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("table.insert",i,a,e.outerHeight())}}function i(){var n=_();if(n){var i=t.popups.get("table.edit");i||(i=l()),t.popups.setContainer("table.edit",e(t.opts.scrollableContainer));var a=R(n),o=(a.left+a.right)/2,r=a.bottom;if(t.popups.show("table.edit",o,r,a.bottom-a.top),t.$el.find(".fr-selected-cell").length>1){t.toolbar.disable(),t.$el.removeClass("fr-no-selection"),t.edit.on();var s=e(t.original_window).scrollTop();t.$el.focus(),t.selection.setAtEnd(t.$el.find(".fr-selected-cell:last").get(0)),t.selection.restore(),e(t.original_window).scrollTop(s),t.button.bulkRefresh()}}}function a(){var n=_();if(n){var i=t.popups.get("table.colors");i||(i=c()),t.popups.setContainer("table.colors",e(t.opts.scrollableContainer));var a=R(n),o=(a.left+a.right)/2,r=a.bottom;u(),t.popups.show("table.colors",o,r,a.bottom-a.top)}}function o(){0===t.$el.get(0).querySelectorAll(".fr-selected-cell").length&&t.toolbar.enable()}function r(){var n="";t.opts.tableInsertButtons.length>0&&(n='<div class="fr-buttons">'+t.button.buildList(t.opts.tableInsertButtons)+"</div>");var i={buttons:n,rows_columns:s()},a=t.popups.create("table.insert",i);return t.popups.onHide("table.insert",function(){a.find('.fr-table-size .fr-select-table-size > span[data-row="1"][data-col="1"]').trigger("mouseenter")}),a.on("mouseenter",".fr-table-size .fr-select-table-size .fr-table-cell",function(n){var i=e(n.currentTarget),a=i.data("row"),o=i.data("col"),r=i.parent();r.siblings(".fr-table-size-info").html(a+" &times; "+o),r.find("> span").removeClass("hover");for(var s=1;s<=t.opts.tableInsertMaxSize;s++)for(var l=0;l<=t.opts.tableInsertMaxSize;l++){var c=r.find('> span[data-row="'+s+'"][data-col="'+l+'"]');a>=s&&o>=l?c.addClass("hover"):a+1>=s||2>=s&&!t.helpers.isMobile()?c.css("display","inline-block"):s>2&&!t.helpers.isMobile()&&c.css("display","none")}}),t.events.on("destroy",function(){a.off("mouseenter",".fr-table-size .fr-select-table-size .fr-table-cell")},!0),a}function s(){for(var e='<div class="fr-table-size"><div class="fr-table-size-info">1 &times; 1</div><div class="fr-select-table-size">',n=1;n<=t.opts.tableInsertMaxSize;n++){for(var i=1;i<=t.opts.tableInsertMaxSize;i++){var a="inline-block";n>2&&!t.helpers.isMobile()&&(a="none");var o="fr-table-cell ";1==n&&1==i&&(o+=" hover"),e+='<span class="fr-command '+o+'" data-cmd="tableInsert" data-row="'+n+'" data-col="'+i+'" data-param1="'+n+'" data-param2="'+i+'" style="display: '+a+';"><span></span></span>'}e+='<div class="new-line"></div>'}return e+="</div></div>"}function l(){var e="";t.opts.tableEditButtons.length>0&&(e='<div class="fr-buttons">'+t.button.buildList(t.opts.tableEditButtons)+"</div>");var n={buttons:e},a=t.popups.create("table.edit",n);return t.popups.onHide("table.edit",o),t.$wp.on("scroll.table-edit",function(){t.popups.isVisible("table.edit")&&i()}),t.events.on("destroy",function(){t.$wp.off("scroll.table-edit")}),a}function c(){var e="";t.opts.tableColorsButtons.length>0&&(e='<div class="fr-buttons fr-table-colors-buttons">'+t.button.buildList(t.opts.tableColorsButtons)+"</div>");var n={buttons:e,colors:d()},i=t.popups.create("table.colors",n);return t.$wp.on("scroll.table-colors",function(){t.popups.isVisible("table.colors")&&a()}),t.events.on("destroy",function(){t.$wp.off("scroll.table-colors")}),i}function d(){for(var e='<div class="fr-table-colors">',n=0;n<t.opts.tableColors.length;n++)0!==n&&n%t.opts.tableColorsStep===0&&(e+="<br>"),e+="REMOVE"!=t.opts.tableColors[n]?'<span class="fr-command" style="background: '+t.opts.tableColors[n]+';" data-cmd="tableCellBackgroundColor" data-param1="'+t.opts.tableColors[n]+'"></span>':'<span class="fr-command" data-cmd="tableCellBackgroundColor" data-param1="REMOVE" title="'+t.language.translate("Clear Formatting")+'"><i class="fa fa-eraser"></i></span>';return e+="</div>"}function u(){var e=t.popups.get("table.colors"),n=t.$el.find(".fr-selected-cell:first");e.find(".fr-selected-color").removeClass("fr-selected-color"),e.find('span[data-param1="'+t.helpers.RGBToHex(n.css("background-color"))+'"]').addClass("fr-selected-color")}function f(n,i){var a,o,r='<table style="width: 100%;"><tbody>',s=100/i;for(a=0;n>a;a++){for(r+="<tr>",o=0;i>o;o++)r+='<td style="width: '+s.toFixed(4)+'%;">',0===a&&0===o&&(r+=e.FroalaEditor.MARKERS),r+="<br></td>";r+="</tr>"}r+="</tbody></table>",t.html.insert(r),t.selection.restore()}function p(){if(t.$el.find(".fr-selected-cell").length>0){var e=t.$el.find(".fr-selected-cell").closest("table");t.selection.setBefore(e.get(0))||t.selection.setAfter(e.get(0)),t.selection.restore(),t.popups.hide("table.edit"),e.remove()}}function g(){var n=t.$el.find(".fr-selected-cell").closest("table");if(n.length>0&&0===n.find("th").length){var a,o="<thead><tr>",r=0;for(n.find("tr:first > td").each(function(){var t=e(this);r+=parseInt(t.attr("colspan"),10)||1}),a=0;r>a;a++)o+="<th><br></th>";o+="</tr></thead>",n.prepend(o),i()}}function h(){var e=t.$el.find(".fr-selected-cell").closest("table"),n=e.find("thead");if(n.length>0)if(0===e.find("tbody tr").length)p();else if(n.remove(),t.$el.find(".fr-selected-cell").length>0)i();else{t.popups.hide("table.edit");var a=e.find("tbody tr:first td:first").get(0);a&&(t.selection.setAtEnd(a),t.selection.restore())}}function m(n){var a=t.$el.find(".fr-selected-cell").closest("table");if(a.length>0){if(t.$el.find("th.fr-selected-cell").length>0&&"above"==n)return;var o,r,s=_(),l=L(s);r="above"==n?l.min_i:l.max_i;var c="<tr>";for(o=0;o<s[r].length;o++)if("below"==n&&r<s.length-1&&s[r][o]==s[r+1][o]||"above"==n&&r>0&&s[r][o]==s[r-1][o]){if(0===o||o>0&&s[r][o]!=s[r][o-1]){var d=e(s[r][o]);d.attr("rowspan",parseInt(d.attr("rowspan"),10)+1)}}else c+="<td><br></td>";c+="</tr>";var u=e(a.find("tr").not(a.find("table tr")).get(r));"below"==n?u.after(c):"above"==n&&(u.before(c),i())}}function v(){var n=t.$el.find(".fr-selected-cell").closest("table");if(n.length>0){var i,a,o,r=_(),s=L(r);if(0===s.min_i&&s.max_i==r.length-1)p();else{for(i=s.max_i;i>=s.min_i;i--){for(o=e(n.find("tr").not(n.find("table tr")).get(i)),a=0;a<r[i].length;a++)if(0===a||r[i][a]!=r[i][a-1]){var l=e(r[i][a]);if(parseInt(l.attr("rowspan"),10)>1){var c=parseInt(l.attr("rowspan"),10)-1;1==c?l.removeAttr("rowspan"):l.attr("rowspan",c)}if(i<r.length-1&&r[i][a]==r[i+1][a]&&(0===i||r[i][a]!=r[i-1][a])){for(var d=r[i][a],u=a;u>0&&r[i][u]==r[i][u-1];)u--;0===u?e(n.find("tr").not(n.find("table tr")).get(i+1)).prepend(d):e(r[i+1][u-1]).after(d)}}var f=o.parent();o.remove(),0===f.find("tr").length&&f.remove(),r=_(n)}s.min_i>0?t.selection.setAtEnd(r[s.min_i-1][0]):t.selection.setAtEnd(r[0][0]),t.selection.restore(),t.popups.hide("table.edit")}}}function y(n){var a=t.$el.find(".fr-selected-cell").closest("table");if(a.length>0){var o,r=_(),s=L(r);o="before"==n?s.min_j:s.max_j;var l,c=100/r[0].length,d=100/(r[0].length+1);a.find("th, td").each(function(){l=e(this),l.data("old-width",l.outerWidth()/a.outerWidth()*100)}),a.find("tr").not(a.find("table tr")).each(function(t){for(var i,a=e(this),s=0,l=0;o>s-1;){if(i=a.find("> th, > td").get(l),!i){i=null;break}i==r[t][s]?(s+=parseInt(e(i).attr("colspan"),10)||1,l++):(s+=parseInt(e(r[t][s]).attr("colspan"),10)||1,"after"==n&&(i=0===l?-1:a.find("> th, > td").get(l-1)))}var u=e(i);if("after"==n&&s-1>o||"before"==n&&o>0&&r[t][o]==r[t][o-1]){if(0===t||t>0&&r[t][o]!=r[t-1][o]){var f=parseInt(u.attr("colspan"),10)+1;u.attr("colspan",f),u.css("width",(u.data("old-width")*d/c+d).toFixed(4)+"%"),u.removeData("old-width")}}else{var p;p=a.find("th").length>0?'<th style="width: '+d.toFixed(4)+'%;"><br></th>':'<td style="width: '+d.toFixed(4)+'%;"><br></td>',-1==i?a.prepend(p):null==i?a.append(p):"before"==n?u.before(p):"after"==n&&u.after(p)}}),a.find("th, td").each(function(){l=e(this),l.data("old-width")&&(l.css("width",(l.data("old-width")*d/c).toFixed(4)+"%"),l.removeData("old-width"))}),i()}}function b(){var n=t.$el.find(".fr-selected-cell").closest("table");if(n.length>0){var i,a,o,r=_(),s=L(r);if(0===s.min_j&&s.max_j==r[0].length-1)p();else{var l=100/r[0].length,c=100/(r[0].length-s.max_j+s.min_j-1);for(n.find("th, td").each(function(){o=e(this),o.hasClass("fr-selected-cell")||o.data("old-width",o.outerWidth()/n.outerWidth()*100)}),a=s.max_j;a>=s.min_j;a--)for(i=0;i<r.length;i++)if(0===i||r[i][a]!=r[i-1][a])if(o=e(r[i][a]),parseInt(o.attr("colspan"),10)>1){var d=parseInt(o.attr("colspan"),10)-1;1==d?o.removeAttr("colspan"):o.attr("colspan",d),o.css("width",((o.data("old-width")-W(a,r))*c/l).toFixed(4)+"%"),o.removeData("old-width")}else{var u=e(o.parent().get(0));o.remove(),0===u.find("> th, > td").length&&(0===u.prev().length||0===u.next().length||u.prev().find("> th[rowspan], > td[rowspan]").length<u.prev().find("> th, > td").length)&&u.remove()}s.min_j>0?t.selection.setAtEnd(r[s.min_i][s.min_j-1]):t.selection.setAtEnd(r[s.min_i][0]),t.selection.restore(),t.popups.hide("table.edit"),n.find("th, td").each(function(){o=e(this),o.data("old-width")&&(o.css("width",(o.data("old-width")*c/l).toFixed(4)+"%"),o.removeData("old-width"))})}}}function w(){if(t.$el.find(".fr-selected-cell").length>1&&(0===t.$el.find("th.fr-selected-cell").length||0===t.$el.find("td.fr-selected-cell").length)){var n,a,o,r=_(),s=L(r),l=t.$el.find(".fr-selected-cell"),c=e(l[0]),d=c.parent(),u=d.find(".fr-selected-cell"),f=c.closest("table"),p=c.html(),g=0;for(n=0;n<u.length;n++)g+=e(u[n]).outerWidth();for(c.css("width",(g/d.outerWidth()*100).toFixed(4)+"%"),s.min_j<s.max_j&&c.attr("colspan",s.max_j-s.min_j+1),s.min_i<s.max_i&&c.attr("rowspan",s.max_i-s.min_i+1),n=1;n<l.length;n++)a=e(l[n]),"<br>"!=a.html()&&""!==a.html()&&(p+="<br>"+a.html()),a.remove();c.html(p),t.selection.setAtEnd(c.get(0)),t.selection.restore(),t.toolbar.enable();var h=f.find("tr:empty");for(n=h.length-1;n>=0;n--)o=e(h[n]),(0===o.prev().length||0===o.next().length||o.prev().find("> th[rowspan], > td[rowspan]").length<o.prev().find("> th, > td").length)&&o.remove();i()}}function k(){if(1==t.$el.find(".fr-selected-cell").length){var n=t.$el.find(".fr-selected-cell"),i=n.parent(),a=n.closest("table"),o=parseInt(n.attr("rowspan"),10),r=_(),s=F(n.get(0),r),l=n.clone().html("<br>");if(o>1){var c=Math.ceil(o/2);c>1?n.attr("rowspan",c):n.removeAttr("rowspan"),o-c>1?l.attr("rowspan",o-c):l.removeAttr("rowspan");for(var d=s.row+c,u=0===s.col?s.col:s.col-1;u>=0&&(r[d][u]==r[d][u-1]||d>0&&r[d][u]==r[d-1][u]);)u--;-1==u?e(a.find("tr").not(a.find("table tr")).get(d)).prepend(l):e(r[d][u]).after(l)}else{var f,p=e("<tr>").append(l);for(f=0;f<r[0].length;f++)if(0===f||r[s.row][f]!=r[s.row][f-1]){var g=e(r[s.row][f]);g.is(n)||g.attr("rowspan",(parseInt(g.attr("rowspan"),10)||1)+1)}i.after(p)}I(),t.popups.hide("table.edit")}}function C(){if(1==t.$el.find(".fr-selected-cell").length){var n=t.$el.find(".fr-selected-cell"),i=parseInt(n.attr("colspan"),10)||1,a=n.parent().outerWidth(),o=n.outerWidth(),r=n.clone().html("<br>"),s=_(),l=F(n.get(0),s);if(i>1){var c=Math.ceil(i/2);o=V(l.col,l.col+c-1,s)/a*100;var d=V(l.col+c,l.col+i-1,s)/a*100;c>1?n.attr("colspan",c):n.removeAttr("colspan"),i-c>1?r.attr("colspan",i-c):r.removeAttr("colspan"),n.css("width",o.toFixed(4)+"%"),r.css("width",d.toFixed(4)+"%")}else{var u;for(u=0;u<s.length;u++)if(0===u||s[u][l.col]!=s[u-1][l.col]){var f=e(s[u][l.col]);if(!f.is(n)){var p=(parseInt(f.attr("colspan"),10)||1)+1;f.attr("colspan",p)}}o=o/a*100/2,n.css("width",o.toFixed(4)+"%"),r.css("width",o.toFixed(4)+"%")}n.after(r),I(),t.popups.hide("table.edit")}}function S(e){"REMOVE"!=e?t.$el.find(".fr-selected-cell").css("background-color",t.helpers.HEXtoRGB(e)):t.$el.find(".fr-selected-cell").css("background-color","")}function E(e){t.$el.find(".fr-selected-cell").css("vertical-align",e)}function T(e){t.$el.find(".fr-selected-cell").css("text-align",e)}function A(e,t,n,i){if(t.length>0){if(!n){var a=Object.keys(i);a.splice(a.indexOf(e),1),t.removeClass(a.join(" "))}t.toggleClass(e)}}function _(n){n=n||null;var i=[];if(null==n&&t.$el.find(".fr-selected-cell").length>0&&(n=t.$el.find(".fr-selected-cell").closest("table")),n){var a=e(n);return a.find("tr").not(a.find("table tr")).each(function(t,n){var a=e(n),o=0;a.find("> th, > td").each(function(n,a){for(var r=e(a),s=parseInt(r.attr("colspan"),10)||1,l=parseInt(r.attr("rowspan"),10)||1,c=t;t+l>c;c++)for(var d=o;o+s>d;d++)i[c]||(i[c]=[]),i[c][d]?o++:i[c][d]=a;o+=s})}),i}}function F(e,t){for(var n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)if(t[n][i]==e)return{row:n,col:i}}function x(e,t,n){for(var i=e+1,a=t+1;i<n.length;){if(n[i][t]!=n[e][t]){i--;break}i++}for(i==n.length&&i--;a<n[e].length;){if(n[e][a]!=n[e][t]){a--;break}a++}return a==n[e].length&&a--,{row:i,col:a}}function I(){var n=t.$el.find(".fr-selected-cell");n.length>0&&n.each(function(){var t=e(this);t.removeClass("fr-selected-cell"),""===t.attr("class")&&t.removeAttr("class")})}function D(){setTimeout(function(){t.selection.clear(),t.$el.addClass("fr-no-selection"),t.edit.off(),t.$el.blur()},0)}function L(e){var n,i=e.length,a=0,o=e[0].length,r=0,s=t.$el.find(".fr-selected-cell");for(n=0;n<s.length;n++){var l=F(s[n],e),c=x(l.row,l.col,e);i=Math.min(l.row,i),a=Math.max(c.row,a),o=Math.min(l.col,o),r=Math.max(c.col,r)}return{min_i:i,max_i:a,min_j:o,max_j:r}}function z(t,n,i,a,o){var r,s,l,c,d=t,u=n,f=i,p=a;for(r=d;u>=r;r++)((parseInt(e(o[r][f]).attr("rowspan"),10)||1)>1||(parseInt(e(o[r][f]).attr("colspan"),10)||1)>1)&&(l=F(o[r][f],o),c=x(l.row,l.col,o),d=Math.min(l.row,d),u=Math.max(c.row,u),f=Math.min(l.col,f),p=Math.max(c.col,p)),((parseInt(e(o[r][p]).attr("rowspan"),10)||1)>1||(parseInt(e(o[r][p]).attr("colspan"),10)||1)>1)&&(l=F(o[r][p],o),c=x(l.row,l.col,o),d=Math.min(l.row,d),u=Math.max(c.row,u),f=Math.min(l.col,f),p=Math.max(c.col,p));for(s=f;p>=s;s++)((parseInt(e(o[d][s]).attr("rowspan"),10)||1)>1||(parseInt(e(o[d][s]).attr("colspan"),10)||1)>1)&&(l=F(o[d][s],o),c=x(l.row,l.col,o),d=Math.min(l.row,d),u=Math.max(c.row,u),f=Math.min(l.col,f),p=Math.max(c.col,p)),((parseInt(e(o[u][s]).attr("rowspan"),10)||1)>1||(parseInt(e(o[u][s]).attr("colspan"),10)||1)>1)&&(l=F(o[u][s],o),c=x(l.row,l.col,o),d=Math.min(l.row,d),u=Math.max(c.row,u),f=Math.min(l.col,f),p=Math.max(c.col,p));return d==t&&u==n&&f==i&&p==a?{min_i:t,max_i:n,min_j:i,max_j:a}:z(d,u,f,p,o)}function R(t){var n=L(t),i=e(t[n.min_i][n.min_j]),a=e(t[n.min_i][n.max_j]),o=e(t[n.max_i][n.min_j]),r=i.offset().left,s=a.offset().left+a.outerWidth(),l=i.offset().top,c=o.offset().top+o.outerHeight();return{left:r,right:s,top:l,bottom:c}}function N(t,n){if(e(t).is(n))I(),e(t).addClass("fr-selected-cell");else{D();var i=_(),a=F(t,i),o=F(n,i),r=z(Math.min(a.row,o.row),Math.max(a.row,o.row),Math.min(a.col,o.col),Math.max(a.col,o.col),i);I();for(var s=r.min_i;s<=r.max_i;s++)for(var l=r.min_j;l<=r.max_j;l++)e(i[s][l]).addClass("fr-selected-cell")}}function M(n){var i=null,a=e(n.target);return"TD"==n.target.tagName||"TH"==n.target.tagName?i=n.target:a.closest("td").length>0?i=a.closest("td").get(0):a.closest("th").length>0&&(i=a.closest("th").get(0)),0===t.$el.find(i).length?null:i}function j(n){if(t.$el.find(".fr-selected-cell").length>0&&!n.shiftKey&&(I(),t.$el.removeClass("fr-no-selection"),t.edit.on()),1==n.which){var i=M(n);if(i){t.popups.hide("table.edit"),n.stopPropagation(),t.events.trigger("image.hideResizer"),t.events.trigger("video.hideResizer"),J=!0;var a=i.tagName.toLowerCase();n.shiftKey&&e(a+".fr-selected-cell").length>0?e(e(a+".fr-selected-cell").closest("table")).is(e(i).closest("table"))?N(ee,i):D():((t.keys.ctrlKey(n)||n.shiftKey)&&D(),ee=i,N(ee,ee))}}}function O(n){if(1==n.which){if(J){J=!1;var a=M(n);a||1!=t.$el.find(".fr-selected-cell").length?t.$el.find(".fr-selected-cell").length>0&&(t.selection.isCollapsed()?i():I()):I()}else t.$tb.is(n.target)||t.$tb.is(e(n.target).closest(t.$tb.get(0)))||(t.$el.get(0).querySelectorAll(".fr-selected-cell").length>0&&t.toolbar.enable(),I());if(ne){ne=!1,Q.removeClass("fr-moving"),t.$el.removeClass("fr-no-selection"),t.edit.on(),Q.find("div").css("opacity",0),Q.hide();var o=parseFloat(Q.css("left"))+t.opts.tableResizerOffset;t.opts.iframe&&(o-=t.$iframe.offset().left),Q.data("release-position",o),Q.removeData("max-left"),Q.removeData("max-right"),K(n)}}}function B(n){if(J===!0){var i=e(n.currentTarget);if(i.closest("table").is(t.$el.find(".fr-selected-cell").closest("table"))){if("TD"==n.currentTarget.tagName&&0===t.$el.find("th.fr-selected-cell").length)return void N(ee,n.currentTarget);if("TH"==n.currentTarget.tagName&&0===t.$el.find("td.fr-selected-cell").length)return void N(ee,n.currentTarget)}D()}}function U(e){(37==e.which||38==e.which||39==e.which||40==e.which)&&t.$el.find(".fr-selected-cell").length>0&&(I(),t.popups.hide("table.edit"))}function P(){Q=e('<div class="fr-table-resizer"><div></div></div>'),t.$wp.append(Q),Q.on("mousedown",function(){ne=!0,Q.addClass("fr-moving"),I(),D(),Q.find("div").css("opacity",1)}),t.events.on("destroy",function(){Q.off("mousedown"),Q.html("").removeData().remove()},!0)}function H(n){te=null;var i=t.document.elementFromPoint(n.pageX-t.window.pageXOffset,n.pageY-t.window.pageYOffset),a=e(i);if(i&&"TD"!=i.tagName&&"TH"!=i.tagName&&(a.closest("td").length>0?i=a.closest("td"):a.closest("th").length>0&&(i=a.closest("th"))),i&&("TD"==i.tagName||"TH"==i.tagName)){if(a=e(i),0===t.$el.find(a).length)return!1;var o=a.offset().left-1,r=o+a.outerWidth();if(Math.abs(n.pageX-o)<=t.opts.tableResizerOffset||Math.abs(r-n.pageX)<=t.opts.tableResizerOffset){var s,l,c,d,u,f=_(a.closest("table")),p=F(i,f),g=x(p.row,p.col,f),h=a.closest("table"),m=h.offset().top,v=h.outerHeight()-1;if(n.pageX-o<=t.opts.tableResizerOffset)if(c=o,p.col>0&&f[p.row][p.col-1]){var y=e(f[p.row][p.col-1]);d=1==(parseInt(y.attr("colspan"),10)||1)?y.offset().left-1+t.opts.tableResizingLimit:o-W(p.col-1,f)+t.opts.tableResizingLimit,u=1==(parseInt(a.attr("colspan"),10)||1)?o+a.outerWidth()-t.opts.tableResizingLimit:o+W(p.col,f)-t.opts.tableResizingLimit,s=p.col-1,l=p.col}else s=null,l=p.col,d=h.parent().offset().left+parseFloat(h.parent().css("padding-left")),u=h.offset().left-1+h.outerWidth()-f[0].length*t.opts.tableResizingLimit;else if(r-n.pageX<=t.opts.tableResizerOffset)if(c=r,g.col<f[g.row].length&&f[g.row][g.col+1]){var b=e(f[g.row][g.col+1]);d=1==(parseInt(a.attr("colspan"),10)||1)?o+t.opts.tableResizingLimit:r-W(g.col,f)+t.opts.tableResizingLimit,u=1==(parseInt(b.attr("colspan"),10)||1)?r+b.outerWidth()-t.opts.tableResizingLimit:r+W(p.col+1,f)-t.opts.tableResizingLimit,s=g.col,l=g.col+1}else{s=g.col,l=null;var w=h.parent();d=h.offset().left-1+f[0].length*t.opts.tableResizingLimit,u=w.offset().left-1+w.width()+parseFloat(w.css("padding-left"))}Q.data("table",h),Q.data("first",s),Q.data("second",l);var k=c-t.window.pageXOffset-t.opts.tableResizerOffset,C=m-t.window.pageYOffset;t.opts.iframe&&(k+=t.$iframe.offset().left-e(t.original_window).scrollLeft(),C+=t.$iframe.offset().top-e(t.original_window).scrollTop(),d+=t.$iframe.offset().left,u+=t.$iframe.offset().left),Q.data("max-left",d),Q.data("max-right",u),Q.data("origin",c-t.window.pageXOffset),Q.css("top",C),Q.css("left",k),Q.css("height",v),Q.find("div").css("height",v),Q.css("padding-left",t.opts.tableResizerOffset),Q.css("padding-right",t.opts.tableResizerOffset),Q.show()}else Q.hide()}}function $(){if(ne){var e=Q.data("table");Q.css("top",e.offset().top-t.window.pageYOffset)}}function K(){var n=Q.data("origin"),i=Q.data("release-position");if(n!==i){var a=Q.data("first"),o=Q.data("second"),r=Q.data("table"),s=r.outerWidth();if(null!==a&&null!==o){var l,c,d,u=_(r),f=[],p=[],g=[],h=[];for(l=0;l<u.length;l++)c=e(u[l][a]),d=e(u[l][o]),f[l]=c.outerWidth(),g[l]=d.outerWidth(),p[l]=f[l]/s*100,h[l]=g[l]/s*100;for(l=0;l<u.length;l++){c=e(u[l][a]),d=e(u[l][o]);var m=(p[l]*(f[l]+i-n)/f[l]).toFixed(4);c.css("width",m+"%"),d.css("width",(p[l]+h[l]-m).toFixed(4)+"%")}}else{var v,y=r.parent(),b=s/y.width()*100;v=null==a?(s-i+n)/s*b:(s+i-n)/s*b,r.css("width",Math.round(v).toFixed(4)+"%")}}Q.removeData("origin"),Q.removeData("release-position"),Q.removeData("first"),Q.removeData("second"),Q.removeData("table"),t.undo.saveStep()}function W(t,n){var i,a=e(n[0][t]).outerWidth();for(i=1;i<n.length;i++)a=Math.min(a,e(n[i][t]).outerWidth());return a}function V(e,t,n){var i,a=0;for(i=e;t>=i;i++)a+=W(i,n);return a}function G(e){if(J===!1&&ne===!1)te&&clearTimeout(te),te=setTimeout(H,30,e);else if(ne){var n=e.pageX-t.window.pageXOffset;t.opts.iframe&&(n+=t.$iframe.offset().left);var i=Q.data("max-left"),a=Q.data("max-right");n>=i&&a>=n?Q.css("left",n-t.opts.tableResizerOffset):i>n&&parseFloat(Q.css("left"),10)>i-t.opts.tableResizerOffset?Q.css("left",i-t.opts.tableResizerOffset):n>a&&parseFloat(Q.css("left"),10)<a-t.opts.tableResizerOffset&&Q.css("left",a-t.opts.tableResizerOffset)}}function q(n){t.node.isEmpty(n.get(0))?n.prepend(e.FroalaEditor.MARKERS):n.prepend(e.FroalaEditor.START_MARKER).append(e.FroalaEditor.END_MARKER)}function Y(n){var i=n.which;if(i==e.FroalaEditor.KEYCODE.TAB&&0===t.opts.tabSpaces){var a;if(t.$el.find(".fr-selected-cell").length>0)a=t.$el.find(".fr-selected-cell:last");else{var o=t.selection.element();"TD"==o.tagName||"TH"==o.tagName?a=e(o):e(o).closest("td").length>0?a=e(o).closest("td"):e(o).closest("th").length>0&&(a=e(o).closest("th"))}a&&(n.preventDefault(),I(),t.popups.hide("table.edit"),n.shiftKey?a.prev().length>0?q(a.prev()):a.closest("tr").length>0&&a.closest("tr").prev().length>0?q(a.closest("tr").prev().find("td:last")):a.closest("tbody").length>0&&a.closest("table").find("thead tr").length>0&&q(a.closest("table").find("thead tr th:last")):a.next().length>0?q(a.next()):a.closest("tr").length>0&&a.closest("tr").next().length>0?q(a.closest("tr").next().find("td:first")):a.closest("thead").length>0&&a.closest("table").find("tbody tr").length>0?q(a.closest("table").find("tbody tr td:first")):(a.addClass("fr-selected-cell"),m("below"),I(),q(a.closest("tr").next().find("td:first"))),t.selection.restore())}}function Z(){return t.$wp?(t.helpers.isMobile()||(J=!1,ne=!1,P(),t.$el.on("mousedown.table"+t.id,j),t.popups.onShow("image.edit",function(){I(),J=!1}),t.popups.onShow("link.edit",function(){I(),J=!1}),t.events.on("commands.mousedown",function(e){e.parents(".fr-toolbar").length>0&&I()}),t.$el.on("mouseenter.table"+t.id,"th, td",B),t.$window.on("mouseup.table"+t.id,O),t.$el.on("keydown.table"+t.id,U),t.$window.on("mousemove.table"+t.id,G),e(t.window).on("scroll.table"+t.id,$),t.events.on("contentChanged",function(){t.$el.find(".fr-selected-cell").length>0&&(i(),t.$el.find("img").on("load.selected-cells",function(){e(this).off("load.selected-cells"),t.$el.find(".fr-selected-cell").length>0&&i()}))}),e(t.original_window).on("resize.table"+t.id,function(){I()}),e(t.window).on("keydown.table"+t.id,function(n){if(t.$el.find(".fr-selected-cell").length>0){if(n.which==e.FroalaEditor.KEYCODE.ESC)return I(),n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),!1;if(n.which==e.FroalaEditor.KEYCODE.BACKSPACE)return n.preventDefault(),!1;if(t.$el.find(".fr-selected-cell").length>1)return n.preventDefault(),!1}}),e(t.window).on("keydown.table"+t.id,i),e(t.window).on("input.table"+t.id,i),e(t.window).on("keyup.table"+t.id,i),t.events.on("html.get",function(e){return e=e.replace(/<(td|th)((?:[\w\W]*?))class="([\w\W]*?)fr-selected-cell([\w\W]*?)"((?:[\w\W]*?))>((?:[\w\W]*?))<\/(td|th)>/g,'<$1$2class="$3$4"$5>$6</$7>'),e=e.replace(/<(td|th)((?:[\w\W]*?)) class=""((?:[\w\W]*?))>((?:[\w\W]*?))<\/(td|th)>/g,"<$1$2$3>$4</$5>")}),t.events.on("destroy",function(){t.$el.off("mousedown.table"+t.id),t.$el.off("mouseenter.table"+t.id,"th, td"),t.$window.off("mouseup.table"+t.id),t.$el.off("keydown.table"+t.id),t.$window.off("mousemove.table"+t.id),e(t.window).off("scroll.table"+t.id),e(t.window).off("keydown.table"+t.id),e(t.window).off("input.table"+t.id),e(t.window).off("keyup.table"+t.id)},!0)),void t.events.on("keydown",Y,!0)):!1}function X(){t.$el.find(".fr-selected-cell").length>0?i():(t.popups.hide("table.insert"),t.toolbar.showInline())}var Q,J,ee,te,ne;return{_init:Z,insert:f,remove:p,insertRow:m,deleteRow:v,insertColumn:y,deleteColumn:b,mergeCells:w,splitCellVertically:C,splitCellHorizontally:k,addHeader:g,removeHeader:h,setBackground:S,showInsertPopup:n,showEditPopup:i,showColorsPopup:a,back:X,verticalAlign:E,horizontalAlign:T,applyStyle:A}},e.FroalaEditor.DefineIcon("insertTable",{NAME:"table"}),e.FroalaEditor.RegisterCommand("insertTable",{title:"Insert Table",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("table.insert")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("table.insert")):this.table.showInsertPopup()}}),e.FroalaEditor.RegisterCommand("tableInsert",{callback:function(e,t,n){this.table.insert(t,n),this.popups.hide("table.insert")}}),e.FroalaEditor.DefineIcon("tableHeader",{NAME:"header"}),e.FroalaEditor.RegisterCommand("tableHeader",{title:"Table Header",focus:!1,callback:function(){var e=this.popups.get("table.edit").find('.fr-command[data-cmd="tableHeader"]');e.hasClass("fr-active")?this.table.removeHeader():this.table.addHeader()},refresh:function(e){var t=this.$el.find(".fr-selected-cell").closest("table");t.length>0&&(0===t.find("th").length?e.removeClass("fr-active"):e.addClass("fr-active"))}}),e.FroalaEditor.DefineIcon("tableRows",{NAME:"bars"}),e.FroalaEditor.RegisterCommand("tableRows",{type:"dropdown",focus:!1,title:"Row",options:{above:"Insert row above",below:"Insert row below","delete":"Delete row"},html:function(){var t='<ul class="fr-dropdown-list">',n=e.FroalaEditor.COMMANDS.tableRows.options;for(var i in n)t+='<li><a class="fr-command" data-cmd="tableRows" data-param1="'+i+'" title="'+this.language.translate(n[i])+'">'+this.language.translate(n[i])+"</a></li>";return t+="</ul>"},callback:function(e,t){"above"==t||"below"==t?this.table.insertRow(t):this.table.deleteRow()}}),e.FroalaEditor.DefineIcon("tableColumns",{NAME:"bars fa-rotate-90"}),e.FroalaEditor.RegisterCommand("tableColumns",{type:"dropdown",focus:!1,title:"Column",options:{before:"Insert column before",after:"Insert column after","delete":"Delete column"},html:function(){var t='<ul class="fr-dropdown-list">',n=e.FroalaEditor.COMMANDS.tableColumns.options;for(var i in n)t+='<li><a class="fr-command" data-cmd="tableColumns" data-param1="'+i+'" title="'+this.language.translate(n[i])+'">'+this.language.translate(n[i])+"</a></li>";return t+="</ul>"},callback:function(e,t){"before"==t||"after"==t?this.table.insertColumn(t):this.table.deleteColumn()}}),e.FroalaEditor.DefineIcon("tableCells",{NAME:"square-o"}),e.FroalaEditor.RegisterCommand("tableCells",{type:"dropdown",focus:!1,title:"Cell",options:{merge:"Merge cells","vertical-split":"Vertical split","horizontal-split":"Horizontal split"},html:function(){var t='<ul class="fr-dropdown-list">',n=e.FroalaEditor.COMMANDS.tableCells.options;for(var i in n)t+='<li><a class="fr-command" data-cmd="tableCells" data-param1="'+i+'" title="'+this.language.translate(n[i])+'">'+this.language.translate(n[i])+"</a></li>";return t+="</ul>"},callback:function(e,t){"merge"==t?this.table.mergeCells():"vertical-split"==t?this.table.splitCellVertically():this.table.splitCellHorizontally()},refreshOnShow:function(e,t){this.$el.find(".fr-selected-cell").length>1?(t.find('a[data-param1="vertical-split"]').addClass("fr-disabled"),t.find('a[data-param1="horizontal-split"]').addClass("fr-disabled"),t.find('a[data-param1="merge"]').removeClass("fr-disabled")):(t.find('a[data-param1="merge"]').addClass("fr-disabled"),t.find('a[data-param1="vertical-split"]').removeClass("fr-disabled"),t.find('a[data-param1="horizontal-split"]').removeClass("fr-disabled"))}}),e.FroalaEditor.DefineIcon("tableRemove",{NAME:"trash"}),e.FroalaEditor.RegisterCommand("tableRemove",{title:"Remove Table",focus:!1,callback:function(){this.table.remove()}}),e.FroalaEditor.DefineIcon("tableStyle",{NAME:"paint-brush"}),e.FroalaEditor.RegisterCommand("tableStyle",{title:"Table Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.tableStyles;for(var n in t)e+='<li><a class="fr-command" data-cmd="tableStyle" data-param1="'+n+'" title="'+this.language.translate(t[n])+'">'+this.language.translate(t[n])+"</a></li>";return e+="</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell").closest("table"),this.opts.tableMultipleStyles,this.opts.tableStyles)},refreshOnShow:function(t,n){var i=this.$el.find(".fr-selected-cell").closest("table");i&&n.find(".fr-command").each(function(){var t=e(this).data("param1");e(this).toggleClass("fr-active",i.hasClass(t))})}}),e.FroalaEditor.DefineIcon("tableCellBackground",{NAME:"tint"}),e.FroalaEditor.RegisterCommand("tableCellBackground",{title:"Cell Background",focus:!1,callback:function(){this.table.showColorsPopup()}}),e.FroalaEditor.RegisterCommand("tableCellBackgroundColor",{undo:!0,focus:!1,callback:function(e,t){this.table.setBackground(t)}}),e.FroalaEditor.DefineIcon("tableBack",{NAME:"arrow-left"}),e.FroalaEditor.RegisterCommand("tableBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.table.back()},refresh:function(e){0!==this.$el.find(".fr-selected-cell").length||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FroalaEditor.DefineIcon("tableCellVerticalAlign",{NAME:"arrows-v"}),e.FroalaEditor.RegisterCommand("tableCellVerticalAlign",{type:"dropdown",focus:!1,title:"Vertical Align",options:{Top:"Align Top",Middle:"Align Middle",Bottom:"Align Bottom"},html:function(){var t='<ul class="fr-dropdown-list">',n=e.FroalaEditor.COMMANDS.tableCellVerticalAlign.options;for(var i in n)t+='<li><a class="fr-command" data-cmd="tableCellVerticalAlign" data-param1="'+i.toLowerCase()+'" title="'+this.language.translate(n[i])+'">'+this.language.translate(i)+"</a></li>";return t+="</ul>"},callback:function(e,t){this.table.verticalAlign(t)},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.$el.find(".fr-selected-cell").css("vertical-align")+'"]').addClass("fr-active")}}),e.FroalaEditor.DefineIcon("tableCellHorizontalAlign",{NAME:"align-left"}),e.FroalaEditor.DefineIcon("align-left",{NAME:"align-left"}),e.FroalaEditor.DefineIcon("align-right",{NAME:"align-right"}),e.FroalaEditor.DefineIcon("align-center",{NAME:"align-center"}),e.FroalaEditor.DefineIcon("align-justify",{NAME:"align-justify"}),e.FroalaEditor.RegisterCommand("tableCellHorizontalAlign",{type:"dropdown",focus:!1,title:"Horizontal Align",options:{left:"Align Left",center:"Align Center",right:"Align Right",justify:"Align Justify"},html:function(){var t='<ul class="fr-dropdown-list">',n=e.FroalaEditor.COMMANDS.tableCellHorizontalAlign.options;for(var i in n)t+='<li><a class="fr-command fr-title" data-cmd="tableCellHorizontalAlign" data-param1="'+i+'" title="'+this.language.translate(n[i])+'">'+this.icon.create("align-"+i)+"</a></li>";return t+="</ul>"},callback:function(e,t){this.table.horizontalAlign(t)},refresh:function(e){e.find("> *:first").replaceWith(this.icon.create("align-"+this.helpers.getAlignment(this.$el.find(".fr-selected-cell:first"))));
},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.helpers.getAlignment(this.$el.find(".fr-selected-cell:first"))+'"]').addClass("fr-active")}}),e.FroalaEditor.DefineIcon("tableCellStyle",{NAME:"magic"}),e.FroalaEditor.RegisterCommand("tableCellStyle",{title:"Cell Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list">',t=this.opts.tableCellStyles;for(var n in t)e+='<li><a class="fr-command" data-cmd="tableCellStyle" data-param1="'+n+'" title="'+this.language.translate(t[n])+'">'+this.language.translate(t[n])+"</a></li>";return e+="</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell"),this.opts.tableCellMultipleStyles,this.opts.tableCellStyles)},refreshOnShow:function(t,n){var i=this.$el.find(".fr-selected-cell:first");i&&n.find(".fr-command").each(function(){var t=e(this).data("param1");e(this).toggleClass("fr-active",i.hasClass(t))})}})});