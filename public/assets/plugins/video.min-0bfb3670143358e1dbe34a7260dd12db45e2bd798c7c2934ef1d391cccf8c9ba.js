/*!
 * froala_editor v2.0.1 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms
 * Copyright 2014-2015 Froala Labs
 */
!function(e){"function"==typeof define&&define.amd?module.exports=function(t,n){return void 0===n&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(n),n}:e(jQuery)}(function(e){"use strict";e.extend(e.FroalaEditor.POPUP_TEMPLATES,{"video.insert":"[_BUTTONS_][_BY_URL_LAYER_][_EMBED_LAYER_]","video.edit":"[_BUTTONS_]","video.size":"[_BUTTONS_][_SIZE_LAYER_]"}),e.extend(e.FroalaEditor.DEFAULTS,{videoInsertButtons:["videoBack","|","videoByURL","videoEmbed"],videoEditButtons:["videoDisplay","videoAlign","videoSize","videoRemove"],videoResize:!0,videoSizeButtons:["videoBack","|"],videoTextNear:!0,videoDefaultAlign:"center",videoDefaultDisplay:"block"}),e.FroalaEditor.VIDEO_PROVIDERS=[{test_regex:/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:m\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=|embed\/)?([0-9a-zA-Z_\-]+)(.+)?/g,url_text:"//www.youtube.com/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:vimeo\.com)\/(?:channels\/[A-z]+\/|groups\/[A-z]+\/videos\/)?(.+)/g,url_text:"//player.vimeo.com/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(dailymotion.com|dai.ly)\/(video|hub)?\/?([^_]+)[^#]*(#video=([^_&]+))?/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:dailymotion\.com|dai\.ly)\/(?:video|hub)?\/?(.+)/g,url_text:"//www.dailymotion.com/embed/video/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen></iframe>'},{test_regex:/^.+(screen.yahoo.com)\/[^_&]+/,url_regex:"",url_text:"",html:'<iframe width="640" height="360" src="{url}?format=embed" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'},{test_regex:/^.+(rutube.ru)\/[^_&]+/,url_regex:/(?:https?:\/\/)?(?:www\.)?(?:rutube\.ru)\/(?:video)?\/?(.+)/g,url_text:"//rutube.ru/play/embed/$1",html:'<iframe width="640" height="360" src="{url}" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" allowtransparency="true"></iframe>'}],e.FroalaEditor.PLUGINS.video=function(t){function n(){var e=t.popups.get("video.insert"),n=e.find(".fr-video-by-url-layer input");n.val("").trigger("change");var i=e.find(".fr-video-embed-layer textarea");i.val("").trigger("change")}function i(){var e=t.$tb.find('.fr-command[data-cmd="insertVideo"]'),n=t.popups.get("video.insert");if(n||(n=o()),!n.hasClass("fr-active")){t.popups.refresh("video.insert"),t.popups.setContainer("video.insert",t.$tb);var i=e.offset().left+e.outerWidth()/2,a=e.offset().top+(t.opts.toolbarBottom?10:e.outerHeight()-10);t.popups.show("video.insert",i,a,e.outerHeight())}}function a(){var n=t.popups.get("video.edit");n||(n=E()),t.popups.setContainer("video.edit",e(t.opts.scrollableContainer)),t.popups.refresh("video.edit");var i=$.find("iframe, embed, video"),a=i.offset().left+i.outerWidth()/2,o=i.offset().top+i.outerHeight();t.popups.show("video.edit",a,o,i.outerHeight())}function o(){var e="";t.opts.videoInsertButtons.length>1&&(e='<div class="fr-buttons">'+t.button.buildList(t.opts.videoInsertButtons)+"</div>");var i="";t.opts.videoInsertButtons.indexOf("videoByURL")>=0&&(i='<div class="fr-video-by-url-layer fr-layer fr-active" id="fr-video-by-url-layer-'+t.id+'"><div class="fr-input-line"><input type="text" placeholder="http://" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertByURL" tabIndex="2">'+t.language.translate("Insert")+"</button></div></div>");var a="";t.opts.videoInsertButtons.indexOf("videoEmbed")>=0&&(a='<div class="fr-video-embed-layer fr-layer" id="fr-video-embed-layer-'+t.id+'"><div class="fr-input-line"><textarea type="text" placeholder="'+t.language.translate("Embedded Code")+'" tabIndex="1" rows="5"></textarea></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoInsertEmbed" tabIndex="2">'+t.language.translate("Insert")+"</button></div></div>");var o={buttons:e,by_url_layer:i,embed_layer:a},r=t.popups.create("video.insert",o);return t.popups.onRefresh("video.insert",n),t.popups.onHide("video.insert",d),r}function r(e){var n,i,a=t.popups.get("video.insert");if(!$&&!t.opts.toolbarInline){var o=t.$tb.find('.fr-command[data-cmd="insertVideo"]');n=o.offset().left+o.outerWidth()/2,i=o.offset().top+(t.opts.toolbarBottom?10:o.outerHeight()-10)}t.opts.toolbarInline&&(i=a.offset().top-t.helpers.getPX(a.css("margin-top")),a.hasClass("fr-above")&&(i+=a.outerHeight())),a.find(".fr-layer").removeClass("fr-active"),a.find(".fr-"+e+"-layer").addClass("fr-active"),t.popups.show("video.insert",n,i,0)}function s(e){var n=t.popups.get("video.insert");n.find(".fr-video-by-url-layer").hasClass("fr-active")&&e.addClass("fr-active")}function l(e){var n=t.popups.get("video.insert");n.find(".fr-video-embed-layer").hasClass("fr-active")&&e.addClass("fr-active")}function d(){}function c(e){t.events.focus(!0),t.selection.restore(),t.html.insert('<span contenteditable="false" class="fr-jiv fr-video fr-dv'+t.opts.videoDefaultDisplay[0]+("center"!=t.opts.videoDefaultAlign?" fr-fv"+t.opts.videoDefaultAlign[0]:"")+'">'+e+"<span>"),t.popups.hide("video.insert");var n=t.$el.find(".fr-jiv");n.removeClass("fr-jiv"),t.events.trigger("video.inserted",[n])}function u(n){if("undefined"==typeof n){var i=t.popups.get("video.insert");n=i.find('.fr-video-by-url-layer input[type="text"]').val()||""}var a=null;if(t.helpers.isURL(n))for(var o=0;o<e.FroalaEditor.VIDEO_PROVIDERS.length;o++){var r=e.FroalaEditor.VIDEO_PROVIDERS[o];if(r.test_regex.test(n)){a=n.replace(r.url_regex,r.url_text),a=r.html.replace(/\{url\}/,a);break}}a?c(a):t.events.trigger("video.linkError",[n])}function f(e){if("undefined"==typeof e){var n=t.popups.get("video.insert");e=n.find(".fr-video-embed-layer textarea").val()||""}0===e.length?t.events.trigger("video.codeError",[e]):c(e)}function p(n){n.preventDefault(),n.stopPropagation();var i=n.pageX||(n.originalEvent.touches?n.originalEvent.touches[0].pageX:null),a=n.pageY||(n.originalEvent.touches?n.originalEvent.touches[0].pageY:null);return i&&a?(P=e(this),P.data("start-x",i),P.data("start-y",a),U.show(),void t.popups.hideAll()):!1}function g(e){if(P){e.preventDefault();var t=e.pageX||(e.originalEvent.touches?e.originalEvent.touches[0].pageX:null),n=e.pageY||(e.originalEvent.touches?e.originalEvent.touches[0].pageY:null);if(!t||!n)return!1;var i=P.data("start-x"),a=P.data("start-y");P.data("start-x",t),P.data("start-y",n);var o=t-i,r=n-a,s=$.find("iframe, embed, video"),l=s.width(),d=s.height();(P.hasClass("fr-hnw")||P.hasClass("fr-hsw"))&&(o=0-o),(P.hasClass("fr-hnw")||P.hasClass("fr-hne"))&&(r=0-r),s.css("width",l+o),s.css("height",d+r),s.removeAttr("width"),s.removeAttr("height"),y()}}function h(e){P&&(e&&e.preventDefault(),P=null,U.hide(),y(),a())}function m(e){return'<div class="fr-handler fr-h'+e+'"></div>'}function v(){if(H=e('<div class="fr-video-resizer"></div>'),t.$wp.append(H),e(t.original_window).on("resize.video"+t.id,w),t.events.on("destroy",function(){H.html("").removeData().remove(),e(t.original_window).off("resize.video"+t.id)},!0),t.opts.videoResize){H.append(m("nw")+m("ne")+m("sw")+m("se"));var n=H.get(0).ownerDocument;H.on(t._mousedown+".vidresize"+t.id,".fr-handler",p),e(n).on(t._mousemove+".vidresize"+t.id,g),e(n.defaultView||n.parentWindow).on(t._mouseup+".vidresize"+t.id,h),U=e('<div class="fr-video-overlay"></div>'),e(n).find("body").append(U),U.on("mouseleave",h),t.events.on("destroy",function(){H.off(t._mousedown+".vidresize"+t.id),e(n).off(t._mousemove+".vidresize"+t.id),e(n.defaultView||n.parentWindow).off(t._mouseup+".vidresize"+t.id),U.off("mouseleave").remove()},!0)}}function y(){H||v();var e=$.find("iframe, embed, video");H.css("top",(t.opts.iframe?e.offset().top-1:e.offset().top-t.$wp.offset().top-1)+t.$wp.scrollTop()).css("left",(t.opts.iframe?e.offset().left-1:e.offset().left-t.$wp.offset().left-1)+t.$wp.scrollLeft()).css("width",e.outerWidth()).css("height",e.height()).addClass("fr-active")}function b(n){return n&&"touchend"==n.type&&K?!0:(n.preventDefault(),n.stopPropagation(),t.edit.isDisabled()?!1:(n.stopPropagation(),t.toolbar.disable(),t.helpers.isMobile()&&(t.events.disableBlur(),t.$el.blur(),t.events.enableBlur()),$=e(this),e(this).addClass("fr-active"),t.opts.iframe&&t.height.syncIframe(),y(),a(),t.selection.clear(),t.button.bulkRefresh(),void t.events.trigger("image.hideResizer")))}function w(e){e===!0&&(W=!0),$&&W&&(H.removeClass("fr-active"),t.toolbar.enable(),$.removeClass("fr-active"),$=null),W=!1}function k(){W=!0}function C(){W=!1}function S(){t.events.on("mousedown",k),t.events.on("window.mousedown",k),t.events.on("window.touchmove",C),t.events.on("mouseup",w),t.events.on("window.mouseup",w),t.events.on("commands.mousedown",function(e){e.parents(".fr-toolbar").length>0&&w()}),t.events.on("video.hideResizer",function(){w(!0)}),t.events.on("commands.undo",function(){w(!0)}),t.events.on("commands.redo",function(){w(!0)})}function E(){var e="";t.opts.videoEditButtons.length>1&&(e+='<div class="fr-buttons">',e+=t.button.buildList(t.opts.videoEditButtons),e+="</div>");var n={buttons:e},i=t.popups.create("video.edit",n);return t.$wp.on("scroll.video-edit",function(){$&&t.popups.isVisible("video.edit")&&a()}),t.events.on("destroy",function(){t.$wp.off("scroll.video-edit")}),i}function A(){if($){var e=t.popups.get("video.size"),n=$.find("iframe, embed, video");e.find('input[name="width"]').val(n.get(0).style.width||n.attr("width")).trigger("change"),e.find('input[name="height"]').val(n.get(0).style.height||n.attr("height")).trigger("change")}}function T(){var n=t.popups.get("video.size");n||(n=_()),t.popups.refresh("video.size"),t.popups.setContainer("video.size",e(t.opts.scrollableContainer));var i=$.find("iframe, embed, video"),a=i.offset().left+i.width()/2,o=i.offset().top+i.height();t.popups.show("video.size",a,o,i.height())}function _(){var e="";e='<div class="fr-buttons">'+t.button.buildList(t.opts.videoSizeButtons)+"</div>";var n="";n='<div class="fr-video-size-layer fr-layer fr-active" id="fr-video-size-layer-'+t.id+'"><div class="fr-video-group"><div class="fr-input-line"><input type="text" name="width" placeholder="'+t.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input type="text" name="height" placeholder="'+t.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="videoSetSize" tabIndex="2">'+t.language.translate("Update")+"</button></div></div>";var i={buttons:e,size_layer:n},a=t.popups.create("video.size",i);return t.popups.onRefresh("video.size",A),t.$wp.on("scroll.video-size",function(){$&&t.popups.isVisible("video.size")&&T()}),t.events.on("destroy",function(){t.$wp.off("scroll.video-size")}),a}function F(e){$.removeClass("fr-fvr fr-fvl"),"left"==e?$.addClass("fr-fvl"):"right"==e&&$.addClass("fr-fvr"),y(),a()}function x(e){$.hasClass("fr-fvl")?e.find("> i").attr("class","fa fa-align-left"):$.hasClass("fr-fvr")?e.find("> i").attr("class","fa fa-align-right"):e.find("> i").attr("class","fa fa-align-justify")}function I(e,t){var n="justify";$.hasClass("fr-fvl")?n="left":$.hasClass("fr-fvr")&&(n="right"),t.find('.fr-command[data-param1="'+n+'"]').addClass("fr-active")}function D(e){$.removeClass("fr-dvi fr-dvb"),"inline"==e?$.addClass("fr-dvi"):"block"==e&&$.addClass("fr-dvb"),y(),a()}function L(e,t){var n="block";$.hasClass("fr-dvi")&&(n="inline"),t.find('.fr-command[data-param1="'+n+'"]').addClass("fr-active")}function R(){if($&&t.events.trigger("video.beforeRemove",[$])!==!1){var e=$;t.popups.hideAll(),w(!0),t.selection.setBefore(e.get(0))||t.selection.setAfter(e.get(0)),e.remove(),t.selection.restore(),t.html.fillEmptyBlocks(!0),t.events.trigger("video.removed",[e])}}function z(e){if(!e.hasClass("fr-dvi")&&!e.hasClass("fr-dvb")){var n=e.css("float");e.css("float","none"),"block"==e.css("display")?(e.css("float",n),0===parseInt(e.css("margin-left"),10)&&(e.attr("style")||"").indexOf("margin-right: auto")>=0?e.addClass("fr-fvl"):0===parseInt(e.css("margin-right"),10)&&(e.attr("style")||"").indexOf("margin-left: auto")>=0&&e.addClass("fr-fvr"),e.addClass("fr-dvb")):(e.css("float",n),"left"==e.css("float")?e.addClass("fr-fvl"):"right"==e.css("float")&&e.addClass("fr-fvr"),e.addClass("fr-dvi")),e.css("margin",""),e.css("float",""),e.css("display",""),e.css("z-index",""),e.css("position",""),e.css("overflow",""),e.css("vertical-align","")}t.opts.videoTextNear||e.removeClass("fr-dvi").addClass("fr-dvb")}function N(){t.$el.find("video").filter(function(){return 0===e(this).parents("span.fr-video").length}).wrap('<span class="fr-video" contenteditable="false"></span>'),t.$el.find("embed, iframe").filter(function(){if(t.browser.safari&&this.getAttribute("src")&&this.setAttribute("src",this.src),e(this).parents("span.fr-video").length>0)return!1;for(var n=e(this).attr("src"),i=0;i<e.FroalaEditor.VIDEO_PROVIDERS.length;i++){var a=e.FroalaEditor.VIDEO_PROVIDERS[i];if(a.test_regex.test(n))return!0}return!1}).map(function(){return 0===e(this).parents("object").length?this:e(this).parents("object").get(0)}).wrap('<span class="fr-video" contenteditable="false"></span>');for(var n=t.$el.find("span.fr-video"),i=0;i<n.length;i++)z(e(n[i]))}function M(){S(),t.helpers.isMobile()&&(t.$el.on("touchstart","span.fr-video",function(){K=!1}),t.$el.on("touchmove",function(){K=!0})),t.events.on("html.set",N),N(),t.$el.on("mousedown","span.fr-video",function(e){e.stopPropagation()}),t.$el.on("click touchend","span.fr-video",b),t.events.on("keydown",function(n){var i=n.which;return!$||i!=e.FroalaEditor.KEYCODE.BACKSPACE&&i!=e.FroalaEditor.KEYCODE.DELETE?$&&i==e.FroalaEditor.KEYCODE.ESC?(w(!0),n.preventDefault(),!1):$&&!t.keys.ctrlKey(n)?(n.preventDefault(),!1):void 0:(n.preventDefault(),R(),!1)},!0),t.events.on("keydown",function(){t.$el.find("span.fr-video:empty").remove()})}function j(){$?$.trigger("click"):(t.popups.hide("video.insert"),t.toolbar.showInline())}function O(e,n){if($){var i=t.popups.get("video.size"),a=$.find("iframe, embed, video");a.css("width",e||i.find('input[name="width"]').val()),a.css("height",n||i.find('input[name="height"]').val()),a.get(0).style.width&&a.removeAttr("width"),a.get(0).style.height&&a.removeAttr("height"),i.find("input").blur(),setTimeout(function(){$.trigger("click")},t.helpers.isAndroid()?50:0)}}function B(){return $}var U,P,H,$,K,W=!1;return{_init:M,showInsertPopup:i,showLayer:r,refreshByURLButton:s,refreshEmbedButton:l,insertByURL:u,insertEmbed:f,insert:c,align:F,refreshAlign:x,refreshAlignOnShow:I,display:D,refreshDisplayOnShow:L,remove:R,showSizePopup:T,back:j,setSize:O,get:B}},e.FroalaEditor.RegisterCommand("insertVideo",{title:"Insert Video",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("video.insert")?(this.$el.find(".fr-marker")&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("video.insert")):this.video.showInsertPopup()}}),e.FroalaEditor.DefineIcon("insertVideo",{NAME:"video-camera"}),e.FroalaEditor.DefineIcon("videoByURL",{NAME:"link"}),e.FroalaEditor.RegisterCommand("videoByURL",{title:"By URL",undo:!1,focus:!1,callback:function(){this.video.showLayer("video-by-url")},refresh:function(e){this.video.refreshByURLButton(e)}}),e.FroalaEditor.DefineIcon("videoEmbed",{NAME:"code"}),e.FroalaEditor.RegisterCommand("videoEmbed",{title:"Embedded Code",undo:!1,focus:!1,callback:function(){this.video.showLayer("video-embed")},refresh:function(e){this.video.refreshEmbedButton(e)}}),e.FroalaEditor.RegisterCommand("videoInsertByURL",{undo:!0,focus:!0,callback:function(){this.video.insertByURL()}}),e.FroalaEditor.RegisterCommand("videoInsertEmbed",{undo:!0,focus:!0,callback:function(){this.video.insertEmbed()}}),e.FroalaEditor.DefineIcon("videoDisplay",{NAME:"star"}),e.FroalaEditor.RegisterCommand("videoDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(e,t){this.video.display(t)},refresh:function(e){this.opts.videoTextNear||e.addClass("fr-hidden")},refreshOnShow:function(e,t){this.video.refreshDisplayOnShow(e,t)}}),e.FroalaEditor.DefineIcon("videoAlign",{NAME:"align-center"}),e.FroalaEditor.RegisterCommand("videoAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",justify:"None",right:"Align Right"},html:function(){var t='<ul class="fr-dropdown-list">',n=e.FroalaEditor.COMMANDS.videoAlign.options;for(var i in n)t+='<li><a class="fr-command fr-title" data-cmd="videoAlign" data-param1="'+i+'" title="'+this.language.translate(n[i])+'"><i class="fa fa-align-'+i+'"></i></a></li>';return t+="</ul>"},callback:function(e,t){this.video.align(t)},refresh:function(e){this.video.refreshAlign(e)},refreshOnShow:function(e,t){this.video.refreshAlignOnShow(e,t)}}),e.FroalaEditor.DefineIcon("videoRemove",{NAME:"trash"}),e.FroalaEditor.RegisterCommand("videoRemove",{title:"Remove",callback:function(){this.video.remove()}}),e.FroalaEditor.DefineIcon("videoSize",{NAME:"arrows-alt"}),e.FroalaEditor.RegisterCommand("videoSize",{undo:!1,focus:!1,title:"Change Size",callback:function(){this.video.showSizePopup()}}),e.FroalaEditor.DefineIcon("videoBack",{NAME:"arrow-left"}),e.FroalaEditor.RegisterCommand("videoBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.video.back()},refresh:function(e){var t=this.video.get();t||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),e.FroalaEditor.RegisterCommand("videoSetSize",{undo:!0,focus:!1,callback:function(){this.video.setSize()}})});